window.Kamome=function(){var n=function(){return navigator.userAgent.toLowerCase().indexOf("android")>0},e=function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("iphone")>0||n.indexOf("ipad")>0||n.indexOf("ipod")>0},i={},t={},a=[],r=!1,o=function(n,e){return i[n]=e,this},u=function(n){return n in i&&delete i[n],this},l=function(n,e,i){return i?(a.push({name:n,data:e,callback:i}),d(),null):new Promise(function(i){a.push({name:n,data:e,resolve:i}),d()})},d=function(){if(!r){r=!0;var i=a[0],o=JSON.stringify({name:i.name,data:i.data});e()?"webkit"in window&&setTimeout(function(){window.webkit.messageHandlers.kamomeSend.postMessage(o)},0):n()?"kamomeAndroid"in window&&setTimeout(function(){window.kamomeAndroid.kamomeSend(o)},0):i.name in t&&setTimeout(function(){var n=function(n){return function(e){s(n,e?JSON.stringify(e):null)}}(i.name);t[i.name](i.data,n)},0)}},s=function(n,e,i){r=!1;var t=e?JSON.parse(e):null,o=a.shift();return n===o.name&&("callback"in o?o.callback(t):"resolve"in o&&o.resolve(t)),a.length>0&&d(),null},c=function(e,t,a){if(e in i){var r=i[e](t?JSON.parse(t):null);return n()?{callbackId:a,result:r}:JSON.stringify({callbackId:a,result:r})}return n()?{callbackId:a,result:null}:JSON.stringify({callbackId:a,result:null})},f=function(n,e){return t[n]=e,this};return{addReceiver:o,removeReceiver:u,send:l,onComplete:s,onReceive:c,addWebHandler:f}}();