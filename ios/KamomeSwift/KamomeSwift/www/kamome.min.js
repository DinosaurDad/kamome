window.Kamome=function(){var e=function(){return navigator.userAgent.toLowerCase().indexOf("android")>0},n=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("iphone")>0||e.indexOf("ipad")>0||e.indexOf("ipod")>0},t={requestTimeout:"RequestTimeout",rejected:"Rejected"},i={},r={},a=[],u=!1,l=null,o=1e4,c=function(e){return o=e,this},s=function(e,n){return i[e]=n,this},d=function(e){return e in i&&delete i[e],this},m=function(e,n,t){return t?(a.push({name:e,data:n,callback:t}),f(),null):new Promise(function(t,i){a.push({name:e,data:n,resolve:t,reject:i}),f()})},f=function(){if(!u){u=!0;var i=a[0],c=JSON.stringify({name:i.name,data:i.data});n()?"webkit"in window&&setTimeout(function(){window.webkit.messageHandlers.kamomeSend.postMessage(c)},0):e()?"kamomeAndroid"in window&&setTimeout(function(){window.kamomeAndroid.kamomeSend(c)},0):i.name in r&&setTimeout(function(){var e=function(e){return function(n){v(e,n?JSON.stringify(n):null)}}(i.name);r[i.name](i.data,e)},0),o>0&&(k(),l=setTimeout(function(){k(),u=!1;var e=a.shift();"callback"in e?e.callback(null,t.requestTimeout+":"+e.name):"reject"in e&&e.reject(t.requestTimeout+":"+e.name),a.length>0&&f()},o))}},k=function(){null!==l&&(clearTimeout(l),l=null)},v=function(e,n,t){k(),u=!1;var i=n?JSON.parse(n):null,r=a.shift();return e===r.name&&("callback"in r?r.callback(i,null):"resolve"in r&&r.resolve(i)),a.length>0&&f(),null},w=function(e,n){k(),u=!1;var i=n?":"+n:"",r=a.shift();return e===r.name&&("callback"in r?r.callback(null,t.rejected+":"+r.name+i):"reject"in r&&r.reject(t.rejected+":"+r.name+i)),a.length>0&&f(),null},b=function(n,t,r){if(n in i){var a=i[n](t?JSON.parse(t):null);return e()?{callbackId:r,result:a}:JSON.stringify({callbackId:r,result:a})}return e()?{callbackId:r,result:null}:JSON.stringify({callbackId:r,result:null})},g=function(e,n){return r[e]=n,this};return{Error:t,setRequestTimeout:c,addReceiver:s,removeReceiver:d,send:m,onComplete:v,onError:w,onReceive:b,addWebHandler:g}}();