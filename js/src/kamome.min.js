window.Kamome=function(){var n=function(){return navigator.userAgent.toLowerCase().indexOf("android")>0},e=function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("iphone")>0||n.indexOf("ipad")>0||n.indexOf("ipod")>0},i={},t={},a=[],o=!1,r=function(n,e){return i[n]=e,this},u=function(n){return n in i&&delete i[n],this},d=function(n,e,i){return i?(a.push({name:n,data:e,callback:i}),s(),null):new Promise(function(i){a.push({name:n,data:e,resolve:i}),s()})},s=function(){if(!o){o=!0;var i=a[0],r=JSON.stringify({name:i.name,data:i.data});e()?"webkit"in window&&setTimeout(function(){window.webkit.messageHandlers.kamomeSend.postMessage(r)},0):n()?"kamomeAndroid"in window&&setTimeout(function(){window.kamomeAndroid.kamomeSend(r)},0):i.name in t&&setTimeout(function(){var n=function(n){return function(e){c(n,e?JSON.stringify(e):null)}}(i.name);t[i.name](i.data,n)},0)}},c=function(n,e){o=!1;var i=e?JSON.parse(e):null,t=a.shift();n===t.name&&("callback"in t?t.callback(i):"resolve"in t&&t.resolve(i)),a.length>0&&s()},m=function(n,e){n in i&&i[n](e?JSON.parse(e):null)},f=function(n,e){return t[n]=e,this};return{addReceiver:r,removeReceiver:u,send:d,onComplete:c,onReceive:m,addWebHandler:f}}();