window.Kamome=function(){var e=function(){return navigator.userAgent.toLowerCase().indexOf("android")>0},n=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("iphone")>0||e.indexOf("ipad")>0||e.indexOf("ipod")>0},t={requestTimeout:"RequestTimeout",failed:"Failed"},i={},a={},r=[],u=!1,l=null,o=1e4,c=function(e){return o=e,this},s=function(e,n){return i[e]=n,this},d=function(e){return e in i&&delete i[e],this},m=function(e,n,t){return t?(r.push({name:e,data:n,callback:t}),f(),null):new Promise(function(t,i){r.push({name:e,data:n,resolve:t,reject:i}),f()})},f=function(){if(!u){u=!0;var i=r[0],c=JSON.stringify({name:i.name,data:i.data});n()?"webkit"in window&&setTimeout(function(){window.webkit.messageHandlers.kamomeSend.postMessage(c)},0):e()?"kamomeAndroid"in window&&setTimeout(function(){window.kamomeAndroid.kamomeSend(c)},0):i.name in a&&setTimeout(function(){var e=function(e){return function(n){v(e,n?JSON.stringify(n):null)}}(i.name);a[i.name](i.data,e)},0),o>0&&(k(),l=setTimeout(function(){k(),u=!1;var e=r.shift();"callback"in e?e.callback(null,t.requestTimeout+":"+e.name):"reject"in e&&e.reject(t.requestTimeout+":"+e.name),r.length>0&&f()},o))}},k=function(){null!==l&&(clearTimeout(l),l=null)},v=function(e,n,t){k(),u=!1;var i=n?JSON.parse(n):null,a=r.shift();return e===a.name&&("callback"in a?a.callback(i,null):"resolve"in a&&a.resolve(i)),r.length>0&&f(),null},w=function(e,n){k(),u=!1;var i=n?":"+n:"",a=r.shift();return e===a.name&&("callback"in a?a.callback(null,t.failed+":"+a.name+i):"reject"in a&&a.reject(t.failed+":"+a.name+i)),r.length>0&&f(),null},b=function(n,t,a){if(n in i){var r=i[n](t?JSON.parse(t):null);return e()?{callbackId:a,result:r}:JSON.stringify({callbackId:a,result:r})}return e()?{callbackId:a,result:null}:JSON.stringify({callbackId:a,result:null})},g=function(e,n){return a[e]=n,this};return{Error:t,setRequestTimeout:c,addReceiver:s,removeReceiver:d,send:m,onComplete:v,onError:w,onReceive:b,addWebHandler:g}}();